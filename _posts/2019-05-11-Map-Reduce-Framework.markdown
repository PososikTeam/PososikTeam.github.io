---
layout: post
categories: blog2
---

{% highlight java %}
{% endhighlight %}

<div class="my_text">
В предыдущей статье была расмотрена общая схема Map-Reduce. Что делать
если мы столкнулись с конкретной задачей? Нужно обеспечить выполнение всех
свойств Мастера: создать директории ввода вывода, создать задачи бля мап
и редюс обеспечить контроль и т.д. Но существуют много готовых решений (один из
 наиболее богатых это фреймворк Hadoop) которые
берут на себя эту функциональность и вот за что они отвечают:
</div>
<img src="/assets/images/MapReduce-08.jpg" class="center">
<div class="my_text">
Для пользователя осталось написать функцию мап и редюс. <br>
Hadoop отвечет за выполнение MapReduce задач:
<ul>
   <li>Подготовка данных, разбиение данных на сплиты и донесение их до воркеров</li>
   <li>Планирование ресурсов(определяет на каких серверах есть свободные ресурсы и на них запускает задачи)</li>
   <li>Передача между этапом мапа и редюса(синхронным образом, нельзя запускать задачу редюса пока все мапы не завершились). Cледит за ошибками 
   в маппере, если произошла обишка перезапускает его и т.д.</li>
    <li>Всё это работает поверх HDFS в Hadoop, ничего не теряется. Кроме того при запуске задачи поверх HDFS 
    достаточно легко произвести спилование(один сплит равен одному блоку и удобно произвести  data_locality - обработка на том
     сервере где лежат данные) </li>
 
  </ul>
</div>
Демоны в Map-Reuce
<img src="/assets/images/MapReduce-09.jpg" class="center">
<div class="my_text">
В Map-Reduce существуют 2 типа демонов:
<ul>
<li>Jobtracker - главный процесс, отвечает за запуск задачи</li>
<li>Tasktracker - запущен на машине кластера и отвечает за запуск конкретных воркеров.(Как и Namenode запускается на отдельном сервере для стабильности работы)</li>
<li>Tasktracker  взаимодействует только с Jobtracker, с другими Tasktracker он не связывается.</li>
</ul>
Tasktracker и datanode обычно лежат вместе для осуществления datalocality.
</div>

Jobtracker
<img src="/assets/images/MapReduce-10.jpg" class="center">
<br>
Tasktracker
<img src="/assets/images/MapReduce-11.jpg" class="center">
<div class="my_text">
Слоты - лежат на каждом тасктрекере и таски запускаются на одном слоте
т.е количество слотов определяют количество воркеров которые могут быть запущены 
на данном сервере. Число слотов определяется из мощности сервера.
<br>
Пусть имеется машина с 16 ядер и 64 Gb ОЗУ, тогда можно выделить 16 слотов
по 4 Gb ОЗУ, но на самом деле  это не так, потому что в имеются ещё другие процессы
например datanode и по итогу мы сможем выделить только 14 слотов по 4 Gb ОЗУ.
<br>
Слоты делятся на мап слоты и редюс слоты.

</div>
<img src="/assets/images/MapReduce-12.jpg" class="center">